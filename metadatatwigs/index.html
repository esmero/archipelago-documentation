
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Project documentation for Archipelago.">
      
      
      
        <meta name="author" content="The Digital Services Team at Metropolitan New York Library Council">
      
      
        <link rel="canonical" href="https://docs.archipelago.nyc/metadatatwigs/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.6">
    
    
      
        <title>Twig Templates and Archipelago - Archipelago Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.802231af.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#twig-templates-and-archipelago" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Archipelago Documentation" class="md-header__button md-logo" aria-label="Archipelago Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Archipelago Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Twig Templates and Archipelago
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Archipelago Documentation" class="md-nav__button md-logo" aria-label="Archipelago Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Archipelago Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Documentation Menu
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../CODE_OF_CONDUCT/" class="md-nav__link">
        Archipelago - code of conduct / anti-harassment policy
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ami/" class="md-nav__link">
        Archipelago Multi-Importer (AMI)
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../archifilepersistencestrategy/" class="md-nav__link">
        Archipelago's File Persistence Strategy
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../createdisplaymodes/" class="md-nav__link">
        Creating Display Modes for Archipelago Digital Objects
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../customwebformelements/" class="md-nav__link">
        Archipelago Custom Webform Elements
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../devops/" class="md-nav__link">
        Archipelago Software Services
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../firstobject/" class="md-nav__link">
        Your First Digital Object
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../generalqa/" class="md-nav__link">
        General Q&A
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../giveortake/" class="md-nav__link">
        Archipelago Contribution Guide [![Google Groups](https://img.icons8.com/wired/32/000000/google-groups.png)](https://groups.google.com/forum/#!forum/archipelago-commons)
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../googleapi/" class="md-nav__link">
        Configuration for Google Sheets API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../inthewild/" class="md-nav__link">
        Archipelago Community
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Twig Templates and Archipelago
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Twig Templates and Archipelago
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-twig" class="md-nav__link">
    What is Twig?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#where-is-twig-used-in-archipelago" class="md-nav__link">
    Where is Twig used in Archipelago?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#twig-templates-as-metadata-display-entities" class="md-nav__link">
    Twig Templates as Metadata Display Entities
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#twig-templates-shipped-with-archipelago" class="md-nav__link">
    Twig Templates Shipped with Archipelago
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instructions-and-examples" class="md-nav__link">
    Instructions and Examples
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../modifyingfileextensionsinwebform/" class="md-nav__link">
        Customizing Webforms: Modifying allowable file extensions
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ourtake/" class="md-nav__link">
        Archipelago's Philosophy & Guiding Principles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../sslsetup/" class="md-nav__link">
        Sslsetup
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../strawberryfield-formatters/" class="md-nav__link">
        Strawberryfield Formatters
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../strawberryfields/" class="md-nav__link">
        Strawberryfields Forever
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../tbd/" class="md-nav__link">
        Documentation Update Needed
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../traditional-install/" class="md-nav__link">
        Traditional install
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../webforms/" class="md-nav__link">
        Webforms
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../webformsasinput/" class="md-nav__link">
        Webforms as input method for Archipelago Digital Objects (ADO)
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../workingtwigs/" class="md-nav__link">
        Working with Twig in Archipelago
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../xdebug/" class="md-nav__link">
        Debugging PHP in Archipelago
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-twig" class="md-nav__link">
    What is Twig?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#where-is-twig-used-in-archipelago" class="md-nav__link">
    Where is Twig used in Archipelago?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#twig-templates-as-metadata-display-entities" class="md-nav__link">
    Twig Templates as Metadata Display Entities
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#twig-templates-shipped-with-archipelago" class="md-nav__link">
    Twig Templates Shipped with Archipelago
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instructions-and-examples" class="md-nav__link">
    Instructions and Examples
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="twig-templates-and-archipelago">Twig Templates and Archipelago</h1>
<p><img alt="ADOlife" src="../images/jsonupcaststar.png" /></p>
<p>Archipelago uses a fast, cached templating system that is core to Drupal, called <code>Twig</code>. In its guts (or its heart?) Archipelago uses this system to transform the <em>close to your needs open schema metadata</em> that lives in every <code>strawberryfield</code> as JSON into <em>close to other one's fixed schema needs metadata</em>. This is quite simple, but it is an essential component of our vision of how a repository should manage metadata.</p>
<h3 id="what-is-twig">What is Twig?</h3>
<p>Twig is a template engine for PHP part of Symfony framework.
- <a href="https://twig.symfony.com">Twig in Symfony</a>
- <a href="https://www.drupal.org/docs/theming-drupal/twig-in-drupal">Twig in Drupal</a>
- A template engine is a processor. It allows you to mix and process <em>templates</em> with <em>data</em> to generate an output <em>document</em>.
    - Template: Some type of static Document (we name this a “Frame”)
    - Data: Your Archipelago Digital Object (ADO) info and your Metadata
    - Processor: Allows you to use a rich and expressive language to pick, check, iterate, transform and output your data inside the Template. We refer to this as “casting”.</p>
<h3 id="where-is-twig-used-in-archipelago">Where is Twig used in Archipelago?</h3>
<p>This templating system is exposed to Archipelago users through the UI, and is stored in the repository as content. This setup empowers users to fully control how metadata is transformed and published without touching their individual sources or needing to manage hard-coded configurations. We named these readily accessible and powerful templates <code>Metadata Display entities</code>, but they serve more than just display needs.</p>
<p>Twig drives <strong>every</strong> Page in a Drupal 8/9/10 environment.
- Twig templates are normally files (.twig.html) that live in your Code.
- Modules provide Templates, Themes provide Templates</p>
<p>Twig drives <strong>every</strong> aspect of your ADO exposure to the world in Archipelago and even batch Ingest.
- Strawberryfield Metadata (JSON, your Data) is passed through a <strong>Metadata Display Entity</strong> which holds:
    - A Twig template (so you do not need to edit Files)
    - A desired output serialization format (the Output Document)</p>
<h3 id="twig-templates-as-metadata-display-entities">Twig Templates as Metadata Display Entities</h3>
<p>Templates or recipes can be shared, exported, ingested, updated, and adapted in many ways. This means you can make changes quickly without having to wait for the next major release of Archipelago or your favorite Metadata Schema Specs Committee’s agreement to implement the next or the last version. This module not only handles metadata but media assets as well. It will extract local or remote URIs and files from your metadata and render them as media viewers: books, 3D models, images, panoramas, A/V, all with IIIF in its soul.</p>
<p><strong>Metadata Display Entities</strong> are used for:
- Display:
    - ADO landing pages (via Drupal Field Formatter)
    - IIIF or JSON driven viewers (via Drupal Field Formatter and using Exposed Metadata Endpoints)
    - Map Formatter (Drupal Field Formatter)
    - Custom Blocks (Drupal Views)
    - Search Result Displays (Drupal Views)
    - Collection and Creative Work Series (old compound) displays (Drupal Views)
- Machinable Output
    - Exposed Metadata Endpoints (Standalone URLs to access metadata)
- Batch Ingest
    - AMI Ingest: To transform your CSV data (one row == DATA) to Strawberry field JSON to generate an ADO</p>
<h3 id="twig-templates-shipped-with-archipelago">Twig Templates Shipped with Archipelago</h3>
<p><strong>Archipelago Ships with:</strong>
- IIIF Manifest V3 for Images  (JSON-LD) Metadata Display
- IIIF Manifest V2 for Images and Documents (JSON-LD) Metadata Display
- GEOJSON (JSON) Metadata Display
- A LoD Display (HTML) Metadata Display
- A General ADO Description (HTML) Metadata Display
- A Schema.org (JSON-LD) Metadata Display
- A Thumbnails (HTML) Metadata Display
- An AMI (JSON) Ingest Template
etc.</p>
<p>You can find these templates here:
- On Github: <a href="https://github.com/esmero/archipelago-deployment/tree/1.0.0-RC2/d8content/metadatadisplays">Templates Shipped with Standard Archipelago Deployments</a>
- In your local instance: http://localhost:8001/metadatadisplay/list</p>
<p><strong>Archipelago (the humans) will keep adding and refining these with every release.</strong></p>
<h3 id="instructions-and-examples">Instructions and Examples</h3>
<p>While a lot of core needs and use cases are covered with the Twig Templates shipped with Archipelago, you may want to <strong>add more Input elements</strong> to your Webforms, which in turn will generate <strong>new JSON Values</strong>, which in turn you may want to <strong>show/expose to end users</strong>.</p>
<p><strong>Knowing</strong> (even if you do not plan to) how to edit or create your own <strong>Twig templates</strong> is important.</p>
<ul>
<li>This guide covers the Basics of <a href="../workingtwigs/">Working With Twig in Archipelago</a></li>
<li>This section contains <a href="../workingtwigs/#full-examples-for-common-uses-cases">Full Examples of Common Use Cases</a></li>
<li>This section covers a <a href="../workingtwigs/#a-recommended-workflow">Recommended Workflow</a></li>
<li>You may also want learn more about what <code>format_strawberryfield</code> can do and what many other possibilities are exposed through our templating system in this guide: <a href="../strawberryfield-formatters/">Strawberryfield Formatters</a>.</li>
</ul>
<hr />
<p>Thank you for reading! Please contact us on our <a href="https://groups.google.com/forum/#!forum/archipelago-commons">Archipelago Commons Google Group</a> with any questions or feedback.</p>
<p>Return to the <a href="..">Archipelago Documentation main page</a>.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../inthewild/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Archipelago Community" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Archipelago Community
            </div>
          </div>
        </a>
      
      
        
        <a href="../modifyingfileextensionsinwebform/" class="md-footer__link md-footer__link--next" aria-label="Next: Customizing Webforms: Modifying allowable file extensions" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Customizing Webforms: Modifying allowable file extensions
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.409db549.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.756773cc.min.js"></script>
      
    
  </body>
</html>